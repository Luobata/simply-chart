{"version":3,"file":"simply-chart.esm.js","sources":["../src/core/index.ts"],"sourcesContent":["/**\n * @description entry core\n */\n\nimport { IConfig } from 'Lib/interface';\n\nexport default class Chart {\n    private dom: HTMLElement;\n    private config: IConfig;\n    private canvas: HTMLCanvasElement;\n    private ctx: CanvasRenderingContext2D;\n    private pixelRatio: number;\n    private data: number[];\n    private margin: number = 2;\n\n    constructor(config: IConfig) {\n        this.config = config;\n        this.defaultValue();\n\n        this.canvasInit();\n\n        this.dom.appendChild(this.canvas);\n    }\n\n    public update(data: number[]): Chart {\n        this.data = data;\n\n        return this;\n    }\n\n    public reset(): void {\n        this.canvas.height = this.canvas.height;\n    }\n\n    public render(): Chart {\n        const marginX: number =\n            (this.config.width - this.margin * 2) / (this.data.length - 1);\n        const maxY: number = Math.max(...this.data);\n        const minY: number = Math.min(...this.data);\n        const rateY: number =\n            maxY !== minY\n                ? (this.config.height - this.margin * 2) / (maxY - minY)\n                : 1;\n        this.reset();\n        this.ctx.save();\n        this.axiesChange();\n        this.ctx.lineCap = 'round';\n        this.ctx.strokeStyle = this.config.color;\n        this.ctx.lineWidth = this.config.lineWidth;\n        this.ctx.beginPath();\n        // this.ctx.moveTo(0, 0);\n\n        for (let i: number = 0; i < this.data.length; i = i + 1) {\n            this.ctx.lineTo(\n                i * marginX * this.pixelRatio,\n                (this.data[i] - minY) * rateY * this.pixelRatio,\n            );\n        }\n\n        this.ctx.stroke();\n        this.ctx.closePath();\n        this.ctx.restore();\n\n        return this;\n    }\n\n    // 参数默认值\n    private defaultValue(): void {\n        this.config.color = this.config.color || 'blue';\n        this.config.lineWidth = this.config.lineWidth || 5;\n    }\n\n    private canvasInit(): void {\n        if (typeof this.config.dom === 'string') {\n            this.dom = document.querySelector(this.config.dom);\n        } else {\n            this.dom = this.config.dom;\n        }\n        this.canvas = document.createElement('canvas');\n        this.ctx = this.canvas.getContext('2d');\n        this.pixelRatio = window.devicePixelRatio;\n\n        this.canvas.width = this.config.width * this.pixelRatio;\n        this.canvas.height = this.config.height * this.pixelRatio;\n\n        this.canvas.style.width = `${this.config.width}px`;\n        this.canvas.style.height = `${this.config.height}px`;\n    }\n\n    private axiesChange(): void {\n        this.ctx.scale(1, -1);\n        this.ctx.translate(\n            this.margin,\n            -this.config.height * this.pixelRatio + this.margin,\n        );\n    }\n}\n"],"names":["config","defaultValue","canvasInit","dom","appendChild","canvas","data","height","marginX","width","margin","length","maxY","Math","max","minY","min","rateY","reset","ctx","save","axiesChange","lineCap","strokeStyle","color","lineWidth","beginPath","i","lineTo","pixelRatio","stroke","closePath","restore","document","querySelector","createElement","getContext","window","devicePixelRatio","style","scale","translate"],"mappings":";;;;;;;;;;mBAegBA,MAAZ;;;mBAFQ,GAAiB,CAAjB;aAGCA,MAAL,GAAcA,MAAd;aACKC,YAAL;aAEKC,UAAL;aAEKC,GAAL,CAASC,WAAT,CAAqB,KAAKC,MAA1B;;;;;+BAGUC;iBACLA,IAAL,GAAYA,IAAZ;mBAEO,IAAP;;;;;iBAIKD,MAAL,CAAYE,MAAZ,GAAqB,KAAKF,MAAL,CAAYE,MAAjC;;;;;gBAIMC,UACF,CAAC,KAAKR,MAAL,CAAYS,KAAZ,GAAoB,KAAKC,MAAL,GAAc,CAAnC,KAAyC,KAAKJ,IAAL,CAAUK,MAAV,GAAmB,CAA5D,CADJ;gBAEMC,OAAeC,KAAKC,GAAL,gCAAY,KAAKR,IAAjB,EAArB;gBACMS,OAAeF,KAAKG,GAAL,gCAAY,KAAKV,IAAjB,EAArB;gBACMW,QACFL,SAASG,IAAT,GACM,CAAC,KAAKf,MAAL,CAAYO,MAAZ,GAAqB,KAAKG,MAAL,GAAc,CAApC,KAA0CE,OAAOG,IAAjD,CADN,GAEM,CAHV;iBAIKG,KAAL;iBACKC,GAAL,CAASC,IAAT;iBACKC,WAAL;iBACKF,GAAL,CAASG,OAAT,GAAmB,OAAnB;iBACKH,GAAL,CAASI,WAAT,GAAuB,KAAKvB,MAAL,CAAYwB,KAAnC;iBACKL,GAAL,CAASM,SAAT,GAAqB,KAAKzB,MAAL,CAAYyB,SAAjC;iBACKN,GAAL,CAASO,SAAT;;iBAGK,IAAIC,IAAY,CAArB,EAAwBA,IAAI,KAAKrB,IAAL,CAAUK,MAAtC,EAA8CgB,IAAIA,IAAI,CAAtD,EAAyD;qBAChDR,GAAL,CAASS,MAAT,CACID,IAAInB,OAAJ,GAAc,KAAKqB,UADvB,EAEI,CAAC,KAAKvB,IAAL,CAAUqB,CAAV,IAAeZ,IAAhB,IAAwBE,KAAxB,GAAgC,KAAKY,UAFzC;;iBAMCV,GAAL,CAASW,MAAT;iBACKX,GAAL,CAASY,SAAT;iBACKZ,GAAL,CAASa,OAAT;mBAEO,IAAP;;;;;;;iBAKKhC,MAAL,CAAYwB,KAAZ,GAAoB,KAAKxB,MAAL,CAAYwB,KAAZ,IAAqB,MAAzC;iBACKxB,MAAL,CAAYyB,SAAZ,GAAwB,KAAKzB,MAAL,CAAYyB,SAAZ,IAAyB,CAAjD;;;;;gBAII,OAAO,KAAKzB,MAAL,CAAYG,GAAnB,KAA2B,QAA/B,EAAyC;qBAChCA,GAAL,GAAW8B,SAASC,aAAT,CAAuB,KAAKlC,MAAL,CAAYG,GAAnC,CAAX;aADJ,MAEO;qBACEA,GAAL,GAAW,KAAKH,MAAL,CAAYG,GAAvB;;iBAECE,MAAL,GAAc4B,SAASE,aAAT,CAAuB,QAAvB,CAAd;iBACKhB,GAAL,GAAW,KAAKd,MAAL,CAAY+B,UAAZ,CAAuB,IAAvB,CAAX;iBACKP,UAAL,GAAkBQ,OAAOC,gBAAzB;iBAEKjC,MAAL,CAAYI,KAAZ,GAAoB,KAAKT,MAAL,CAAYS,KAAZ,GAAoB,KAAKoB,UAA7C;iBACKxB,MAAL,CAAYE,MAAZ,GAAqB,KAAKP,MAAL,CAAYO,MAAZ,GAAqB,KAAKsB,UAA/C;iBAEKxB,MAAL,CAAYkC,KAAZ,CAAkB9B,KAAlB,GAA6B,KAAKT,MAAL,CAAYS,KAAzC;iBACKJ,MAAL,CAAYkC,KAAZ,CAAkBhC,MAAlB,GAA8B,KAAKP,MAAL,CAAYO,MAA1C;;;;;iBAIKY,GAAL,CAASqB,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB;iBACKrB,GAAL,CAASsB,SAAT,CACI,KAAK/B,MADT,EAEI,CAAC,KAAKV,MAAL,CAAYO,MAAb,GAAsB,KAAKsB,UAA3B,GAAwC,KAAKnB,MAFjD;;;;;;;;;"}